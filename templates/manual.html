<!DOCTYPE HTML>
<html lang="ru">
<head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<link href="static/manual/styles.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="static/manual/scripts.js"></script>
<script type="text/javascript" src="static/manual/tinymce/tinymce.min.js"></script>

</head>

<body>
<nav class="navbar navbar-expand-lg bg-body-tertiary sticky-top">
    <div class="container">
        <a class="navbar-brand" href="/">
            <img src="static/img/logo_mega.svg" alt="Megagroup" width="200">
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                <li class="nav-item me-2">
                    <a class="btn btn-success" href="/">Главная</a>
                </li>
                <li class="nav-item me-2">
                    <a class="btn btn-outline-success disabled" disabled aria-current="page" href="#">Настройки</a>
                </li>
                <li class="nav-item me-2">
                    <a class="btn btn-success" href="/history">История</a>
                </li>

                <li class="nav-item me-2">
                    <a class="btn btn-success" href="/manual">Ручной парсер</a>
                </li>
            </ul>
        </div>
    </div>
</nav>

<form id="myForm" action="/save_json" method="post">
<div class="form-block">
	<div class="name"><input type="text" name="name" placeholder="Название файла. Пример: support"></div>
	<div class="url"><input type="text" name="url" placeholder="URL"></div>
	<div class="title"><input type="text" name="title" placeholder="title"></div>
	<!-- <div class="links"><textarea name="links" id="links" cols="30" rows="10" placeholder="Links"></textarea></div> -->
	<div class="content"><textarea name="content" id="mytextarea" cols="30" rows="10" placeholder="Content"></textarea></div>
	<input type="submit" value="GetJSON">
</div>
</form>
    <script type="text/javascript">
		tinymce.init({
		  selector: '#mytextarea',
		  plugins: 'code',
		  toolbar: 'undo redo | formatselect | bold italic | code',
		  block_formats: 'Paragraph=p; Heading 1=h1; Heading 2=h2; Heading 3=h3; Heading 4=h4; Heading 5=h5; Heading 6=h6'
		});



		  document.getElementById("myForm").addEventListener("submit", function(event) {
		    event.preventDefault(); // Останавливаем стандартное поведение отправки формы

		    // Получаем данные формы
		    const formData = new FormData(event.target);

		    // Преобразуем FormData в обычный объект
		    const formObj = Object.fromEntries(formData.entries());

		    // Преобразуем объект в JSON
		    const jsonData = JSON.stringify(formObj, null, 2); // Добавляем отступы для удобного форматирования

            fetch('/save_json', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: jsonData
            })
            .then(response => response.json())
            .then(result => {
                alert(result.message || result.error);
                window.location.reload();
            })
            .catch(error => {
                console.error('Ошибка:', error);
                alert('Произошла ошибка при отправке данных');
            });

		  });


    </script>

</body>
</html>
